{"version":3,"file":"RAFManager.js","sources":["../src/RAFManager.js"],"sourcesContent":["/**\n *  RAFManager requestAnimationFrame Manager\n *\n *  Simple package\n *\n *  CODE:\n *\n * \t\t// Add to\n *  \t-- RAFManager.add(func);\n *\n *   \t// Add and carry parameters\n *  \t-- const func = data =>{ console.log(data) };\n *  \t-- RAFManager.add(func, 25, { msg:'hello world!' });\n *\n * \t\t// remove\n *  \t-- RAFManager.remove(func);\n *  \t-- RAFManager.stop();\n */\n\n// simple polyfill by https://gist.github.com/paulirish/1579671\n(function () {\n  let lastTime = 0;\n  let vendors = [\"ms\", \"moz\", \"webkit\", \"o\"];\n  for (let x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\n    window.requestAnimationFrame = window[vendors[x] + \"RequestAnimationFrame\"];\n    window.cancelAnimationFrame =\n      window[vendors[x] + \"CancelAnimationFrame\"] ||\n      window[vendors[x] + \"CancelRequestAnimationFrame\"];\n  }\n})();\n\nconst RAFManager = {\n  timer: 0,\n  state: \"stop\",\n  animations: [],\n  paused: false,\n  immediate: true,\n\n  add(callback, fps = 60, param = null) {\n    const n = 60 / fps;\n    const aniData = { callback, fps, n, param, i: 0 };\n    this.animations.push(aniData);\n    if (this.immediate && this.animations.length >= 1) this.start();\n    \n    return this;\n  },\n\n  getIndex(callback) {\n    for (let i = 0; i < this.animations.length; i++) {\n      const aniData = this.animations[i];\n      if (aniData.callback === callback) return i;\n    }\n\n    return -1;\n  },\n\n  remove(callback) {\n    const index = this.getIndex(callback);\n    if (index < 0) return;\n\n    this.deleteMap(callback);\n    if (this.immediate && this.animations.length === 0) this.stop();\n\n    return this;\n  },\n\n  deleteMap(callback) {\n    const index = this.getIndex(callback);\n    const aniData = this.animations[index];\n    for (let key in aniData) delete aniData[key];\n\n    this.animations.splice(index, 1);\n  },\n\n  start() {\n    if (this.state === \"start\") return;\n\n    this.state = \"start\";\n    this.tick();\n    return this;\n  },\n\n  stop() {\n    if (this.state === \"stop\") return;\n\n    this.state = \"stop\";\n    cancelAnimationFrame(this.timer);\n    return this;\n  },\n\n  pause() {\n    if (this.state !== \"start\" || this.paused) return;\n    this.paused = true;\n    return this;\n  },\n\n  resume() {\n    if (this.state !== \"start\" || !this.paused) return;\n    this.paused = false;\n    return this;\n  },\n\n  tick() {\n    this.timer = requestAnimationFrame(() => {\n      this.tick();\n    });\n\n    if (this.paused) return;\n    for (let i = 0; i < this.animations.length; i++) {\n      const aniData = this.animations[i];\n      const callback = aniData.callback;\n      const param = aniData.param;\n\n      aniData.i++;\n      if (aniData.i >= aniData.n) {\n        callback(param);\n        aniData.i = 0;\n      }\n    }\n  },\n};\n\nexport default RAFManager;\n"],"names":["vendors","x","length","window","requestAnimationFrame","cancelAnimationFrame","RAFManager","callback","fps","param","n","aniData","i","animations","push","immediate","start","index","getIndex","deleteMap","stop","key","splice","state","tick","timer","paused"],"mappings":"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"}